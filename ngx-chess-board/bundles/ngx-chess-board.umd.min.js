!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/cdk/drag-drop"),require("@angular/common"),require("@angular/core"),require("rxjs"),require("lodash")):"function"==typeof define&&define.amd?define("ngx-chess-board",["exports","@angular/cdk/drag-drop","@angular/common","@angular/core","rxjs","lodash"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["ngx-chess-board"]={},e.ng.cdk.dragDrop,e.ng.common,e.ng.core,e.rxjs,e.lodash)}(this,(function(e,t,i,o,n,r){"use strict";var s=function(){function e(e,t){this.row=e,this.col=t}return e.prototype.isEqual=function(e){return e&&this.row===e.row&&this.col===e.col},e.prototype.hasCoordsEqual=function(e,t){return e&&t&&this.row===e&&this.col===t},e}(),a=function(){function e(e,t,i){this.x=e+.5,this.y=t+.5,this.color=i}return e.prototype.isEqual=function(e){return e&&e.x===this.x&&this.y===e.y},e}(),c=function(){function e(){}return e.getClickPoint=function(e,t,i,o,n){return new s(Math.floor((e.y-t)/(i/8)),Math.floor((e.x-o)/(n/8)))},e.getDrawingPoint=function(e,t,i,o,n,r,s,c,d){var h=e/8,l=Math.floor((i-c)/h),p=Math.floor((o-d)/h),u=t.resolve(n,s,r);return new a(Math.floor(l*h+h/2),Math.floor(p*h+h/2),u)},e}(),d=function(e,t,i,o){this.move=e,this.piece=t,this.color=i,this.x=o},h=function(e,t){return(h=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])})(e,t)};function l(e,t){function i(){this.constructor=e}h(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}Object.create;function p(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var o,n,r=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(o=r.next()).done;)s.push(o.value)}catch(e){n={error:e}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}return s}function u(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}var f;Object.create;!function(e){e[e.WHITE=0]="WHITE",e[e.BLACK=1]="BLACK"}(f||(f={}));var b=function(e,t,i,o,n){this.checkPoints=[],this.color=t,this.constant=i,this.point=e,this.relValue=o,this.board=n},y=function(e){function t(t,i,o,n){var r=e.call(this,t,i,o,5,n)||this;return r.isMovedAlready=!1,r}return l(t,e),t.prototype.getPossibleMoves=function(){for(var e=[],t=this.point.row,i=this.point.col,o=t+1;o<8&&this.board.isFieldEmpty(o,i);++o)e.push(new s(o,i));for(o=t-1;o>=0&&this.board.isFieldEmpty(o,i);--o)e.push(new s(o,i));for(var n=i-1;n>=0&&this.board.isFieldEmpty(t,n);--n)e.push(new s(t,n));for(n=i+1;n<8&&this.board.isFieldEmpty(t,n);++n)e.push(new s(t,n));return e},t.prototype.getPossibleCaptures=function(){for(var e=[],t=this.point.row,i=this.point.col,o=t+1;o<8;++o){if(this.board.isFieldTakenByEnemy(o,i,this.color===f.WHITE?f.BLACK:f.WHITE)){e.push(new s(o,i));break}if(!this.board.isFieldEmpty(o,i))break}for(o=t-1;o>=0;--o){if(this.board.isFieldTakenByEnemy(o,i,this.color===f.WHITE?f.BLACK:f.WHITE)){e.push(new s(o,i));break}if(!this.board.isFieldEmpty(o,i))break}for(var n=i-1;n>=0;--n){if(this.board.isFieldTakenByEnemy(t,n,this.color===f.WHITE?f.BLACK:f.WHITE)){e.push(new s(t,n));break}if(!this.board.isFieldEmpty(t,n))break}for(n=i+1;n<8;++n){if(this.board.isFieldTakenByEnemy(t,n,this.color===f.WHITE?f.BLACK:f.WHITE)){e.push(new s(t,n));break}if(!this.board.isFieldEmpty(t,n))break}return e},t.prototype.getCoveredFields=function(){for(var e=[],t=this.point.row,i=this.point.col,o=t+1;o<8;++o)if(this.board.isFieldEmpty(o,i))e.push(new s(o,i));else if(!(this.board.getPieceByField instanceof g)){e.push(new s(o,i));break}for(o=t-1;o>=0;--o)if(this.board.isFieldEmpty(o,i))e.push(new s(o,i));else if(!(this.board.getPieceByField instanceof g)){e.push(new s(o,i));break}for(var n=i-1;n>=0;--n)if(this.board.isFieldEmpty(t,n))e.push(new s(t,n));else if(!(this.board.getPieceByField instanceof g)){e.push(new s(t,n));break}for(n=i+1;n<8;++n)if(this.board.isFieldEmpty(t,n))e.push(new s(t,n));else if(!(this.board.getPieceByField instanceof g)){e.push(new s(t,n));break}return e},t}(b),g=function(e){function t(t,i,o,n){var r=e.call(this,t,i,o,0,n)||this;return r.castledAlready=!1,r.shortCastled=!1,r.longCastled=!1,r.isCastling=!1,r}return l(t,e),t.prototype.getPossibleMoves=function(){var e=[],t=this.point.row,i=this.point.col;if(this.board.isFieldEmpty(t,i-1)&&!this.board.isFieldUnderAttack(t,i-1,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t,i-1)),this.board.isFieldEmpty(t,i+1)&&!this.board.isFieldUnderAttack(t,i+1,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t,i+1)),this.board.isFieldEmpty(t+1,i)&&!this.board.isFieldUnderAttack(t+1,i,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t+1,i)),this.board.isFieldEmpty(t-1,i)&&!this.board.isFieldUnderAttack(t-1,i,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t-1,i)),this.board.isFieldEmpty(t-1,i-1)&&!this.board.isFieldUnderAttack(t-1,i-1,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t-1,i-1)),this.board.isFieldEmpty(t-1,i+1)&&!this.board.isFieldUnderAttack(t-1,i+1,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t-1,i+1)),this.board.isFieldEmpty(t+1,i-1)&&!this.board.isFieldUnderAttack(t+1,i-1,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t+1,i-1)),this.board.isFieldEmpty(t+1,i+1)&&!this.board.isFieldUnderAttack(t+1,i+1,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t+1,i+1)),!this.isMovedAlready){for(var o=!0,n=i-1;n>0;--n)if(!this.board.isFieldEmpty(t,n)||this.board.isFieldUnderAttack(t,n,this.color===f.WHITE?f.BLACK:f.WHITE)){o=!1;break}if(o&&!this.board.isKingInCheck(this.color,this.board.pieces)&&this.board.getPieceByField(t,0)){var r=this.board.getPieceByField(t,0);r instanceof y&&(r.isMovedAlready||e.push(new s(t,i-2)))}var a=!0;for(n=i+1;n<7;++n)if(!this.board.isFieldEmpty(t,n)||this.board.isFieldUnderAttack(t,n,this.color===f.WHITE?f.BLACK:f.WHITE)){a=!1;break}if(a&&!this.board.isKingInCheck(this.color,this.board.pieces)&&this.board.getPieceByField(t,7)){var c=this.board.getPieceByField(t,7);c instanceof y&&(c.isMovedAlready||e.push(new s(t,i+2)))}}return e},t.prototype.getPossibleCaptures=function(){var e=[],t=this.point.row,i=this.point.col;return this.board.isFieldTakenByEnemy(t,i-1,this.color===f.WHITE?f.BLACK:f.WHITE)&&!this.board.isFieldUnderAttack(t,i-1,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t,i-1)),this.board.isFieldTakenByEnemy(t,i+1,this.color===f.WHITE?f.BLACK:f.WHITE)&&!this.board.isFieldUnderAttack(t,i+1,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t,i+1)),this.board.isFieldTakenByEnemy(t+1,i,this.color===f.WHITE?f.BLACK:f.WHITE)&&!this.board.isFieldUnderAttack(t+1,i,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t+1,i)),this.board.isFieldTakenByEnemy(t-1,i,this.color===f.WHITE?f.BLACK:f.WHITE)&&!this.board.isFieldUnderAttack(t-1,i,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t-1,i)),this.board.isFieldTakenByEnemy(t-1,i-1,this.color===f.WHITE?f.BLACK:f.WHITE)&&!this.board.isFieldUnderAttack(t-1,i-1,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t-1,i-1)),this.board.isFieldTakenByEnemy(t-1,i+1,this.color===f.WHITE?f.BLACK:f.WHITE)&&!this.board.isFieldUnderAttack(t-1,i+1,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t-1,i+1)),this.board.isFieldTakenByEnemy(t+1,i-1,this.color===f.WHITE?f.BLACK:f.WHITE)&&!this.board.isFieldUnderAttack(t+1,i-1,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t+1,i-1)),this.board.isFieldTakenByEnemy(t+1,i+1,this.color===f.WHITE?f.BLACK:f.WHITE)&&!this.board.isFieldUnderAttack(t+1,i+1,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t+1,i+1)),e},t.prototype.getCoveredFields=function(){var e=[],t=this.point.row,i=this.point.col;return e.push(new s(t,i-1)),e.push(new s(t,i+1)),e.push(new s(t+1,i)),e.push(new s(t-1,i)),e.push(new s(t-1,i-1)),e.push(new s(t-1,i+1)),e.push(new s(t+1,i-1)),e.push(new s(t+1,i+1)),e},t}(b),w=function(e){function t(t,i,o,n){return e.call(this,t,i,o,3,n)||this}return l(t,e),t.prototype.getPossibleMoves=function(){for(var e=[],t=this.point.row,i=this.point.col,o=t-1,n=i-1;o>=0&&n>=0&&this.board.isFieldEmpty(o,n);--o,--n)e.push(new s(o,n));for(o=t-1,n=i+1;o>=0&&n<8&&this.board.isFieldEmpty(o,n);--o,++n)e.push(new s(o,n));for(o=t+1,n=i-1;o<8&&n>=0&&this.board.isFieldEmpty(o,n);++o,--n)e.push(new s(o,n));for(o=t+1,n=i+1;o<8&&n<8&&this.board.isFieldEmpty(o,n);++o,++n)e.push(new s(o,n));return e},t.prototype.getPossibleCaptures=function(){for(var e=[],t=this.point.row,i=this.point.col,o=t-1,n=i-1;o>=0&&n>=0;--o,--n){if(this.board.isFieldTakenByEnemy(o,n,this.color===f.WHITE?f.BLACK:f.WHITE)){e.push(new s(o,n));break}if(!this.board.isFieldEmpty(o,n))break}for(o=t-1,n=i+1;o>=0&&n<8;--o,++n){if(this.board.isFieldTakenByEnemy(o,n,this.color===f.WHITE?f.BLACK:f.WHITE)){e.push(new s(o,n));break}if(!this.board.isFieldEmpty(o,n))break}for(o=t+1,n=i-1;o<8&&n>=0;++o,--n){if(this.board.isFieldTakenByEnemy(o,n,this.color===f.WHITE?f.BLACK:f.WHITE)){e.push(new s(o,n));break}if(!this.board.isFieldEmpty(o,n))break}for(o=t+1,n=i+1;o<8&&n<8;++o,++n){if(this.board.isFieldTakenByEnemy(o,n,this.color===f.WHITE?f.BLACK:f.WHITE)){e.push(new s(o,n));break}if(!this.board.isFieldEmpty(o,n))break}return e},t.prototype.getCoveredFields=function(){for(var e=[],t=this.point.row,i=this.point.col,o=t-1,n=i-1;o>=0&&n>=0;--o,--n){if(!this.board.isFieldEmpty(o,n)){this.board.getPieceByField(o,n)instanceof g||e.push(new s(o,n));break}e.push(new s(o,n))}for(o=t-1,n=i+1;o>=0&&n<8;--o,++n){if(!this.board.isFieldEmpty(o,n)){this.board.getPieceByField(o,n)instanceof g||e.push(new s(o,n));break}e.push(new s(o,n))}for(o=t+1,n=i-1;o<8&&n>=0;++o,--n){if(!this.board.isFieldEmpty(o,n)){this.board.getPieceByField(o,n)instanceof g||e.push(new s(o,n));break}e.push(new s(o,n))}for(o=t+1,n=i+1;o<8&&n<8;++o,++n){if(!this.board.isFieldEmpty(o,n)){this.board.getPieceByField(o,n)instanceof g||e.push(new s(o,n));break}e.push(new s(o,n))}return e},t}(b),v=function(e){function t(t,i,o,n){var r=e.call(this,t,i,o,3,n)||this;return r.isMovedAlready=!1,r}return l(t,e),t.prototype.getPossibleMoves=function(){var e=[],t=this.point.row,i=this.point.col;return this.board.isFieldEmpty(t-2,i-1)&&e.push(new s(t-2,i-1)),this.board.isFieldEmpty(t-2,i+1)&&e.push(new s(t-2,i+1)),this.board.isFieldEmpty(t-1,i-2)&&e.push(new s(t-1,i-2)),this.board.isFieldEmpty(t-1,i+2)&&e.push(new s(t-1,i+2)),this.board.isFieldEmpty(t+1,i-2)&&e.push(new s(t+1,i-2)),this.board.isFieldEmpty(t+1,i+2)&&e.push(new s(t+1,i+2)),this.board.isFieldEmpty(t+2,i-1)&&e.push(new s(t+2,i-1)),this.board.isFieldEmpty(t+2,i+1)&&e.push(new s(t+2,i+1)),e},t.prototype.getPossibleCaptures=function(){var e=[],t=this.point.row,i=this.point.col;return this.board.isFieldTakenByEnemy(t-2,i-1,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t-2,i-1)),this.board.isFieldTakenByEnemy(t-2,i+1,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t-2,i+1)),this.board.isFieldTakenByEnemy(t-1,i-2,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t-1,i-2)),this.board.isFieldTakenByEnemy(t-1,i+2,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t-1,i+2)),this.board.isFieldTakenByEnemy(t+1,i-2,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t+1,i-2)),this.board.isFieldTakenByEnemy(t+1,i+2,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t+1,i+2)),this.board.isFieldTakenByEnemy(t+2,i-1,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t+2,i-1)),this.board.isFieldTakenByEnemy(t+2,i+1,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t+2,i+1)),e},t.prototype.getCoveredFields=function(){var e=[],t=this.point.row,i=this.point.col;return e.push(new s(t-2,i-1)),e.push(new s(t-2,i+1)),e.push(new s(t-1,i-2)),e.push(new s(t-1,i+2)),e.push(new s(t+1,i-2)),e.push(new s(t+1,i+2)),e.push(new s(t+2,i-1)),e.push(new s(t+2,i+1)),e},t}(b),E=function(e){function t(t,i,o,n){var r=e.call(this,t,i,o,1,n)||this;return r.isMovedAlready=!1,r}return l(t,e),t.prototype.getPossibleMoves=function(){var e=[],t=this.point.row,i=this.point.col;return!this.board.reverted&&this.color===f.WHITE||this.board.reverted&&this.color===f.BLACK?this.board.isFieldEmpty(t-1,i)&&(e.push(new s(t-1,i)),!this.isMovedAlready&&this.board.isFieldEmpty(t-2,i)&&e.push(new s(t-2,i))):
/*!board.isFieldTakenByEnemy(row + 1, col, Color.WHITE) &&*/this.board.isFieldEmpty(t+1,i)&&(e.push(new s(t+1,i)),!this.isMovedAlready&&this.board.isFieldEmpty(t+2,i)&&e.push(new s(t+2,i))),e},t.prototype.getPossibleCaptures=function(){var e=[],t=this.point.row,i=this.point.col;return!this.board.reverted&&this.color===f.WHITE||this.board.reverted&&this.color===f.BLACK?(this.board.isFieldTakenByEnemy(t-1,i-1,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t-1,i-1)),this.board.isFieldTakenByEnemy(t-1,i+1,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t-1,i+1))):(this.board.isFieldTakenByEnemy(t+1,i-1,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t+1,i-1)),this.board.isFieldTakenByEnemy(t+1,i+1,this.color===f.WHITE?f.BLACK:f.WHITE)&&e.push(new s(t+1,i+1))),this.board.enPassantPoint&&this.board.enPassantPiece.color===(this.color===f.WHITE?f.BLACK:f.WHITE)&&t===this.board.enPassantPiece.point.row&&1===Math.abs(this.board.enPassantPiece.point.col-i)&&e.push(this.board.enPassantPoint),e},t.prototype.getCoveredFields=function(){var e=[],t=this.point.row,i=this.point.col;return!this.board.reverted&&this.color===f.WHITE||this.board.reverted&&this.color===f.BLACK?(e.push(new s(t-1,i-1)),e.push(new s(t-1,i+1))):(e.push(new s(t+1,i-1)),e.push(new s(t+1,i+1))),e},t}(b),C=function(e){function t(t,i,o,n){return e.call(this,t,i,o,9,n)||this}return l(t,e),t.prototype.getPossibleMoves=function(){for(var e=[],t=this.point.row,i=this.point.col,o=t-1,n=i-1;o>=0&&n>=0&&this.board.isFieldEmpty(o,n);--o,--n)e.push(new s(o,n));for(o=t-1,n=i+1;o>=0&&n<8&&this.board.isFieldEmpty(o,n);--o,++n)e.push(new s(o,n));for(o=t+1,n=i-1;o<8&&n>=0&&this.board.isFieldEmpty(o,n);++o,--n)e.push(new s(o,n));for(o=t+1,n=i+1;o<8&&n<8&&this.board.isFieldEmpty(o,n);++o,++n)e.push(new s(o,n));for(o=t+1;o<8&&this.board.isFieldEmpty(o,i);++o)e.push(new s(o,i));for(o=t-1;o>=0&&this.board.isFieldEmpty(o,i);--o)e.push(new s(o,i));for(n=i-1;n>=0&&this.board.isFieldEmpty(t,n);--n)e.push(new s(t,n));for(n=i+1;n<8&&this.board.isFieldEmpty(t,n);++n)e.push(new s(t,n));return e},t.prototype.getPossibleCaptures=function(){for(var e=[],t=this.point.row,i=this.point.col,o=t-1,n=i-1;o>=0&&n>=0;--o,--n){if(this.board.isFieldTakenByEnemy(o,n,this.color===f.WHITE?f.BLACK:f.WHITE)){e.push(new s(o,n));break}if(!this.board.isFieldEmpty(o,n))break}for(o=t-1,n=i+1;o>=0&&n<8;--o,++n){if(this.board.isFieldTakenByEnemy(o,n,this.color===f.WHITE?f.BLACK:f.WHITE)){e.push(new s(o,n));break}if(!this.board.isFieldEmpty(o,n))break}for(o=t+1,n=i-1;o<8&&n>=0;++o,--n){if(this.board.isFieldTakenByEnemy(o,n,this.color===f.WHITE?f.BLACK:f.WHITE)){e.push(new s(o,n));break}if(!this.board.isFieldEmpty(o,n))break}for(o=t+1,n=i+1;o<8&&n<8;++o,++n){if(this.board.isFieldTakenByEnemy(o,n,this.color===f.WHITE?f.BLACK:f.WHITE)){e.push(new s(o,n));break}if(!this.board.isFieldEmpty(o,n))break}for(o=t+1;o<8;++o){if(this.board.isFieldTakenByEnemy(o,i,this.color===f.WHITE?f.BLACK:f.WHITE)){e.push(new s(o,i));break}if(!this.board.isFieldEmpty(o,i))break}for(o=t-1;o>=0;--o){if(this.board.isFieldTakenByEnemy(o,i,this.color===f.WHITE?f.BLACK:f.WHITE)){e.push(new s(o,i));break}if(!this.board.isFieldEmpty(o,i))break}for(n=i-1;n>=0;--n){if(this.board.isFieldTakenByEnemy(t,n,this.color===f.WHITE?f.BLACK:f.WHITE)){e.push(new s(t,n));break}if(!this.board.isFieldEmpty(t,n))break}for(n=i+1;n<8;++n){if(this.board.isFieldTakenByEnemy(t,n,this.color===f.WHITE?f.BLACK:f.WHITE)){e.push(new s(t,n));break}if(!this.board.isFieldEmpty(t,n))break}return e},t.prototype.getCoveredFields=function(){for(var e=[],t=this.point.row,i=this.point.col,o=t+1;o<8;++o){if(!this.board.isFieldEmpty(o,i)){this.board.getPieceByField(o,i)instanceof g||e.push(new s(o,i));break}e.push(new s(o,i))}for(o=t-1;o>=0;--o){if(!this.board.isFieldEmpty(o,i)){this.board.getPieceByField(o,i)instanceof g||e.push(new s(o,i));break}e.push(new s(o,i))}for(var n=i-1;n>=0;--n){if(!this.board.isFieldEmpty(t,n)){this.board.getPieceByField(t,n)instanceof g||e.push(new s(t,n));break}e.push(new s(t,n))}for(n=i+1;n<8;++n){if(!this.board.isFieldEmpty(t,n)){this.board.getPieceByField(t,n)instanceof g||e.push(new s(t,n));break}e.push(new s(t,n))}for(o=t-1,n=i-1;o>=0&&n>=0;--o,--n){if(!this.board.isFieldEmpty(o,n)){this.board.getPieceByField(o,n)instanceof g||e.push(new s(o,n));break}e.push(new s(o,n))}for(o=t-1,n=i+1;o>=0&&n<8;--o,++n){if(!this.board.isFieldEmpty(o,n)){this.board.getPieceByField(o,n)instanceof g||e.push(new s(o,n));break}e.push(new s(o,n))}for(o=t+1,n=i-1;o<8&&n>=0;++o,--n){if(!this.board.isFieldEmpty(o,n)){this.board.getPieceByField(o,n)instanceof g||e.push(new s(o,n));break}e.push(new s(o,n))}for(o=t+1,n=i+1;o<8&&n<8;++o,++n){if(!this.board.isFieldEmpty(o,n)){this.board.getPieceByField(o,n)instanceof g||e.push(new s(o,n));break}e.push(new s(o,n))}return e},t}(b),P={WHITE_KING:{name:"King",icon:"&#x2654;"},WHITE_QUEEN:{name:"Queen",icon:"&#x2655;"},WHITE_KNIGHT:{name:"Knight",icon:"&#x2658"},WHITE_ROOK:{name:"Rook",icon:"&#x2656"},WHITE_PAWN:{name:"Pawn",icon:"&#x2659"},WHITE_BISHOP:{name:"Bishop",icon:"&#x2657"},BLACK_KING:{name:"King",icon:"&#x265A"},BLACK_QUEEN:{name:"Queen",icon:"&#x265B"},BLACK_KNIGHT:{name:"Knight",icon:"&#x265E"},BLACK_ROOK:{name:"Rook",icon:"&#x265C"},BLACK_PAWN:{name:"Pawn",icon:"&#x265F"},BLACK_BISHOP:{name:"Bishop",icon:"&#x265D"}},m=function(){function e(e){this.board=e}return e.prototype.addPieces=function(){this.board.pieces=[];for(var e=0;e<8;++e)this.board.pieces.push(new E(new s(1,e),f.BLACK,P.BLACK_PAWN,this.board));this.board.pieces.push(new y(new s(0,0),f.BLACK,P.BLACK_ROOK,this.board)),this.board.pieces.push(new v(new s(0,1),f.BLACK,P.BLACK_KNIGHT,this.board)),this.board.pieces.push(new w(new s(0,2),f.BLACK,P.BLACK_BISHOP,this.board)),this.board.pieces.push(new C(new s(0,3),f.BLACK,P.BLACK_QUEEN,this.board)),this.board.pieces.push(new g(new s(0,4),f.BLACK,P.BLACK_KING,this.board)),this.board.pieces.push(new w(new s(0,5),f.BLACK,P.BLACK_BISHOP,this.board)),this.board.pieces.push(new v(new s(0,6),f.BLACK,P.BLACK_KNIGHT,this.board)),this.board.pieces.push(new y(new s(0,7),f.BLACK,P.BLACK_ROOK,this.board));for(e=0;e<8;++e)this.board.pieces.push(new E(new s(6,e),f.WHITE,P.WHITE_PAWN,this.board));this.board.pieces.push(new y(new s(7,0),f.WHITE,P.WHITE_ROOK,this.board)),this.board.pieces.push(new v(new s(7,1),f.WHITE,P.WHITE_KNIGHT,this.board)),this.board.pieces.push(new w(new s(7,2),f.WHITE,P.WHITE_BISHOP,this.board)),this.board.pieces.push(new C(new s(7,3),f.WHITE,P.WHITE_QUEEN,this.board)),this.board.pieces.push(new g(new s(7,4),f.WHITE,P.WHITE_KING,this.board)),this.board.pieces.push(new w(new s(7,5),f.WHITE,P.WHITE_BISHOP,this.board)),this.board.pieces.push(new v(new s(7,6),f.WHITE,P.WHITE_KNIGHT,this.board)),this.board.pieces.push(new y(new s(7,7),f.WHITE,P.WHITE_ROOK,this.board)),this.board.calculateFEN()},e.prototype.loadFEN=function(e){if(console.log(e),!e)throw Error("Incorrect FEN provided");this.board.reverted=!1,this.board.pieces=[];for(var t=e.split("/"),i=0;i<8;++i)for(var o=0,n=0;n<8;++n){var r=t[i].charAt(n);if(r.match(/[0-9]/))o+=Number(r);else{switch(r){case"r":this.board.pieces.push(new y(new s(i,o),f.BLACK,P.BLACK_ROOK,this.board));break;case"n":this.board.pieces.push(new v(new s(i,o),f.BLACK,P.BLACK_KNIGHT,this.board));break;case"b":this.board.pieces.push(new w(new s(i,o),f.BLACK,P.BLACK_BISHOP,this.board));break;case"q":this.board.pieces.push(new C(new s(i,o),f.BLACK,P.BLACK_QUEEN,this.board));break;case"k":this.board.pieces.push(new g(new s(i,o),f.BLACK,P.BLACK_KING,this.board));break;case"p":((a=new E(new s(i,o),f.BLACK,P.BLACK_PAWN,this.board)).color===f.BLACK&&1!==a.point.row||a.color===f.WHITE&&6!==a.point.row)&&(a.isMovedAlready=!0),this.board.pieces.push(a);break;case"R":this.board.pieces.push(new y(new s(i,o),f.WHITE,P.WHITE_ROOK,this.board));break;case"N":this.board.pieces.push(new v(new s(i,o),f.WHITE,P.WHITE_KNIGHT,this.board));break;case"B":this.board.pieces.push(new w(new s(i,o),f.WHITE,P.WHITE_BISHOP,this.board));break;case"Q":this.board.pieces.push(new C(new s(i,o),f.WHITE,P.WHITE_QUEEN,this.board));break;case"K":this.board.pieces.push(new g(new s(i,o),f.WHITE,P.WHITE_KING,this.board));break;case"P":var a;((a=new E(new s(i,o),f.WHITE,P.WHITE_PAWN,this.board)).color===f.BLACK&&1!==a.point.row||a.color===f.WHITE&&6!==a.point.row)&&(a.isMovedAlready=!0),this.board.pieces.push(a)}++o}}this.setCurrentPlayer(e),this.setCastles(e),this.setEnPassant(e),this.setFullMoveCount(e)},e.prototype.setBoard=function(e){this.board=e},e.prototype.setCurrentPlayer=function(e){if(e){var t=e.split(" ");this.board.currentWhitePlayer="w"===t[1]}},e.prototype.setCastles=function(e){if(e){var t=e.split(" ")[2];t.includes("K")||this.setRookAlreadyMoved(f.WHITE,7),t.includes("Q")||this.setRookAlreadyMoved(f.WHITE,0),t.includes("k")||this.setRookAlreadyMoved(f.BLACK,7),t.includes("q")||this.setRookAlreadyMoved(f.BLACK,0)}},e.prototype.setFullMoveCount=function(e){},e.prototype.setEnPassant=function(e){if(e&&"-"===e.split(" ")[3])return},e.prototype.setRookAlreadyMoved=function(e,t){var i=this.board.pieces.find((function(i){return i.color===e&&i instanceof y&&i.point.col===t}));i&&(i.isMovedAlready=!0)},e}(),I=function(e){this.board=e},k=function(){function e(){this.statesSubject$=new n.BehaviorSubject([])}return Object.defineProperty(e.prototype,"states",{get:function(){return this.statesSubject$.value},set:function(e){this.statesSubject$.next(e)},enumerable:!1,configurable:!0}),e.prototype.addMove=function(e){this.states=u(this.states,[e])},e.prototype.getStates=function(){return this.states},e.prototype.pop=function(){var e=this.getLastState();return this.states=this.states.filter((function(t){return t!==e})),e},e.prototype.isEmpty=function(){return 0===this.states.length},e.prototype.clear=function(){this.states=[]},e.prototype.getLastState=function(){return this.states[this.getLastStateIndex()]},e.prototype.getLastStateIndex=function(){return this.states.length-1},e}(),F=function(){function e(){this.defaultXCoords=["a","b","c","d","e","f","g","h"],this.defaultYCoords=[8,7,6,5,4,3,2,1],this.currentXCoords=u(this.defaultXCoords),this.currentYCoords=u(this.defaultYCoords)}return Object.defineProperty(e.prototype,"xCoords",{get:function(){return this.currentXCoords},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yCoords",{get:function(){return this.currentYCoords},enumerable:!1,configurable:!0}),e.prototype.reverse=function(){this.currentXCoords=this.currentXCoords.reverse(),this.currentYCoords=this.currentYCoords.reverse()},e.prototype.reset=function(){this.init()},e.prototype.init=function(){this.currentXCoords=u(this.defaultXCoords),this.currentYCoords=u(this.defaultYCoords)},e}(),T=function(){function e(){}return e.prototype.isEqual=function(e){return e&&this.start.isEqual(e.start)&&this.end.isEqual(e.end)},e}(),A=function(){function e(){}return e.prototype.isEqual=function(e){return e&&this.drawPoint.isEqual(e.drawPoint)},e}(),B=function(){function e(){}return e.prototype.resolve=function(e,t,i){var o="green";return(e||t)&&(o="red"),i&&(o="blue"),(t||e)&&i&&(o="orange"),o},e}(),H=function(){function e(){this.colorProcessor=new B}return e.prototype.resolve=function(e,t,i){return this.colorProcessor.resolve(e,t,i)},e.prototype.setColorProcessor=function(e){this.colorProcessor=e},e}(),M=function(){function e(){this.arrowsSubject$=new n.BehaviorSubject([]),this.circlesSubject$=new n.BehaviorSubject([]),this.arrows$=this.arrowsSubject$.asObservable(),this.circles$=this.circlesSubject$.asObservable()}return Object.defineProperty(e.prototype,"circles",{get:function(){return this.circlesSubject$.value},set:function(e){this.circlesSubject$.next(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"arrows",{get:function(){return this.arrowsSubject$.value},set:function(e){this.arrowsSubject$.next(e)},enumerable:!1,configurable:!0}),e.prototype.addCircle=function(e){this.circles=u(this.circles,[e])},e.prototype.reomveCircle=function(e){this.circles=this.circles.filter((function(t){return!t.isEqual(e)}))},e.prototype.addArrow=function(e){this.arrows=u(this.arrows,[e])},e.prototype.removeArrow=function(e){this.arrows=this.arrows.filter((function(t){return!t.isEqual(e)}))},e.prototype.containsCircle=function(e){return this.circles.some((function(t){return t.isEqual(e)}))},e.prototype.containsArrow=function(e){return this.arrows.some((function(t){return t.isEqual(e)}))},e.prototype.clear=function(){this.arrows=[],this.circles=[]},e}(),W=function(){function e(){this.historyMovesSubject$=new n.BehaviorSubject([])}return Object.defineProperty(e.prototype,"historyMoves",{get:function(){return this.historyMovesSubject$.value},set:function(e){this.historyMovesSubject$.next(e)},enumerable:!1,configurable:!0}),e.prototype.addMove=function(e){this.historyMoves=u(this.historyMoves,[e])},e.prototype.pop=function(){var e=this.getLastMove();return this.historyMoves=this.historyMoves.filter((function(t){return t!==e})),e},e.prototype.getAll=function(){return this.historyMoves},e.prototype.clear=function(){this.historyMoves=[]},e.prototype.getLastMove=function(){return this.historyMoves[this.getLastMoveIndex()]},e.prototype.getLastMoveIndex=function(){return this.historyMoves.length-1},e}(),_=function(){function e(e,t,i){this._xAxis=e,this._yAxis=t,this._reverted=i}return Object.defineProperty(e.prototype,"xAxis",{get:function(){return this._xAxis},set:function(e){this._xAxis=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"yAxis",{get:function(){return this._yAxis},set:function(e){this._yAxis=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reverted",{get:function(){return this._reverted},set:function(e){this._reverted=e},enumerable:!1,configurable:!0}),e}(),K=function(){function e(){}return e.willMoveCauseCheck=function(e,t,i,o,n,r){var s=r.getPieceByField(t,i),a=r.getPieceByField(o,n);s&&(s.point.row=o,s.point.col=n),a&&(r.pieces=r.pieces.filter((function(e){return e!==a})));var c=r.isKingInCheck(e,r.pieces);return s&&(s.point.col=i,s.point.row=t),a&&r.pieces.push(a),c},e.format=function(e,t,i){if(i){var o=104-e.col,n=104-t.col;return String.fromCharCode(o)+(e.row+1)+String.fromCharCode(n)+(t.row+1)}return String.fromCharCode(e.col+97)+(Math.abs(e.row-7)+1)+String.fromCharCode(t.col+97)+(Math.abs(t.row-7)+1)},e.translateCoordsToIndex=function(e,t){var i,o;return t?(i=104-e.charCodeAt(0),o=+e.charAt(1)-1):(i=e.charCodeAt(0)-97,o=Math.abs(+e.charAt(1)-8)),new _(i,o,t)},e}(),x=function(e){function t(t,i,o,n){var r=e.call(this,t)||this;return r.pointClicked=i,r.color=o,r.board=n,r}return l(t,e),t.prototype.getPossibleCaptures=function(){var e=this;return this.piece.getPossibleCaptures().filter((function(t){return!K.willMoveCauseCheck(e.color,e.pointClicked.row,e.pointClicked.col,t.row,t.col,e.board)}))},t.prototype.getPossibleMoves=function(){var e=this;return this.piece.getPossibleMoves().filter((function(t){return!K.willMoveCauseCheck(e.color,e.pointClicked.row,e.pointClicked.col,t.row,t.col,e.board)}))},t}((function(e){this.piece=e})),L=function(){function e(){}return e.resolvePromotionChoice=function(e,t,i){var o=t.color===f.WHITE;switch(i){case 1:e.pieces.push(new C(t.point,t.color,o?P.WHITE_QUEEN:P.BLACK_QUEEN,e));break;case 2:e.pieces.push(new y(t.point,t.color,o?P.WHITE_ROOK:P.BLACK_ROOK,e));break;case 3:e.pieces.push(new w(t.point,t.color,o?P.WHITE_BISHOP:P.BLACK_BISHOP,e));break;case 4:e.pieces.push(new v(t.point,t.color,o?P.WHITE_KNIGHT:P.BLACK_KNIGHT,e))}},e}(),S=function(){};S.DEFAULT_DARK_TILE_COLOR="rgb(97, 84, 61)",S.DEFAULT_LIGHT_TILE_COLOR="#BAA378",S.DEFAULT_SIZE=500,S.MIN_BOARD_SIZE=100,S.MAX_BOARD_SIZE=4e3;var O,D,N=function(){function e(){this._defaultIcons=!1}return Object.defineProperty(e.prototype,"pieceIconInput",{get:function(){return this._pieceIconInput},set:function(e){this._pieceIconInput=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"defaultIcons",{get:function(){return this._defaultIcons},set:function(e){this._defaultIcons=e},enumerable:!1,configurable:!0}),e.prototype.isDefaultIcons=function(){return void 0===this.pieceIconInput||null===this.pieceIconInput},e.prototype.getPieceIcon=function(e){var t=e.color===f.WHITE;switch(e.constructor){case g:return t?this.pieceIconInput.whiteKingUrl:this.pieceIconInput.blackKingUrl;case C:return t?this.pieceIconInput.whiteQueenUrl:this.pieceIconInput.blackQueenUrl;case y:return t?this.pieceIconInput.whiteRookUrl:this.pieceIconInput.blackRookUrl;case w:return t?this.pieceIconInput.whiteBishopUrl:this.pieceIconInput.blackBishopUrl;case v:return t?this.pieceIconInput.whiteKnightUrl:this.pieceIconInput.blackKnightUrl;case E:return t?this.pieceIconInput.whitePawnUrl:this.pieceIconInput.blackPawnUrl}},e.prototype.loadDefaultData=function(){this.pieceIconInput={blackBishopUrl:"",blackKingUrl:"",blackKnightUrl:"",blackQueenUrl:"",blackRookUrl:"",whiteBishopUrl:"",whiteKingUrl:"",whiteKnightUrl:"",whitePawnUrl:"",whiteQueenUrl:"",whiteRookUrl:"",blackPawnUrl:"a"}},e}(),U=function(){function e(){}return e.prototype.dragEnded=function(e){e.source.reset(),e.source.element.nativeElement.style.zIndex="0",e.source.element.nativeElement.style.pointerEvents="auto",e.source.element.nativeElement.style.touchAction="auto"},e}(),R=function(){function e(){this.dragEndProcessor=new U}return e.prototype.process=function(e){this.dragEndProcessor.dragEnded(e)},e.prototype.setDragEndProcessor=function(e){this.dragEndProcessor=e},e}(),j=function(){function e(){}return e.prototype.dragStarted=function(e){var t=e.source.element.nativeElement.style;t.position="relative",t.zIndex="1000",t.touchAction="none",t.pointerEvents="none"},e}(),G=function(){function e(){this.dragStartProcessor=new j}return e.prototype.process=function(e){this.dragStartProcessor.dragStarted(e)},e.prototype.setDragStartProcessor=function(e){this.dragStartProcessor=e},e}();!function(e){e[e.KING=1]="KING",e[e.QUEEN=2]="QUEEN",e[e.BISHOP=3]="BISHOP",e[e.KNIGHT=4]="KNIGHT",e[e.ROOK=5]="ROOK",e[e.PAWN=6]="PAWN"}(O||(O={})),function(e){e[e.LIGHT=1]="LIGHT",e[e.DARK=2]="DARK"}(D||(D={}));var q=function(){function e(){}return e.create=function(e,t,i,o){var n,r=i===D.LIGHT?f.WHITE:f.BLACK;switch(t){case O.QUEEN:n=new C(new s(e.yAxis,e.xAxis),r,r===f.WHITE?P.WHITE_QUEEN:P.BLACK_QUEEN,o);break;case O.KING:n=new g(new s(e.yAxis,e.xAxis),r,r===f.WHITE?P.WHITE_KING:P.BLACK_KING,o);break;case O.KNIGHT:n=new v(new s(e.yAxis,e.xAxis),r,r===f.WHITE?P.WHITE_KNIGHT:P.BLACK_KNIGHT,o);break;case O.BISHOP:n=new w(new s(e.yAxis,e.xAxis),r,r===f.WHITE?P.WHITE_BISHOP:P.BLACK_BISHOP,o);break;case O.ROOK:n=new y(new s(e.yAxis,e.xAxis),r,r===f.WHITE?P.WHITE_ROOK:P.BLACK_ROOK,o);break;case O.PAWN:n=new E(new s(e.yAxis,e.xAxis),r,r===f.WHITE?P.WHITE_PAWN:P.BLACK_PAWN,o)}return n},e}(),Q=function(){function e(e,t){this._selected=!1,this._freeMode=!1,this.disabling=!1,this.heightAndWidth=S.DEFAULT_SIZE,this.coords=new F,this.dragStartStrategy=new G,this.dragEndStrategy=new R,this.colorStrategy=new H,this._board=e,this.moveChange=t,this.boardLoader=new m(this.board),this.boardLoader.addPieces(),this.drawProvider=new M,this.pieceIconManager=new N,this.boardStateProvider=new k,this.moveHistoryProvider=new W}return e.prototype.reset=function(){this.boardStateProvider.clear(),this.moveHistoryProvider.clear(),this.boardLoader.addPieces(),this.board.reset(),this.coords.reset(),this.drawProvider.clear(),this.freeMode=!1},e.prototype.undo=function(){if(!this.boardStateProvider.isEmpty()){var e=this.boardStateProvider.pop().board;this.board.reverted&&e.reverse(),this.board=e,this.boardLoader.setBoard(this.board),this.board.possibleCaptures=[],this.board.possibleMoves=[],this.moveHistoryProvider.pop()}},e.prototype.getMoveHistory=function(){return this.moveHistoryProvider.getAll()},e.prototype.saveMoveClone=function(){var e=this.board.clone();this.board.reverted&&e.reverse(),this.moveStateProvider.addMove(new I(e))},e.prototype.move=function(e){if(e){var t=K.translateCoordsToIndex(e.substring(0,2),this._board.reverted),i=K.translateCoordsToIndex(e.substring(2,4),this._board.reverted),o=this._board.getPieceByPoint(t.yAxis,t.xAxis);if(o){if(this._board.currentWhitePlayer&&o.color===f.BLACK||!this._board.currentWhitePlayer&&o.color===f.WHITE)return;this.prepareActivePiece(o,o.point),this._board.isPointInPossibleMoves(new s(i.yAxis,i.xAxis))||this._board.isPointInPossibleCaptures(new s(i.yAxis,i.xAxis))?(this.saveClone(),this.movePiece(o,new s(i.yAxis,i.xAxis),5===e.length?+e.substring(4,5):0),this._board.lastMoveSrc=new s(t.yAxis,t.xAxis),this._board.lastMoveDest=new s(i.yAxis,i.xAxis),this.disableSelection()):this.disableSelection()}}},e.prototype.prepareActivePiece=function(e,t){this._board.activePiece=e,this._selected=!0,this._board.possibleCaptures=new x(e,t,this._board.currentWhitePlayer?f.WHITE:f.BLACK,this._board).getPossibleCaptures(),this._board.possibleMoves=new x(e,t,this._board.currentWhitePlayer?f.WHITE:f.BLACK,this._board).getPossibleMoves()},e.prototype.onPieceClicked=function(e,t){this._board.currentWhitePlayer&&e.color===f.BLACK||!this._board.currentWhitePlayer&&e.color===f.WHITE||this.prepareActivePiece(e,t)},e.prototype.handleClickEvent=function(e,t){var i=!1;(this._board.isPointInPossibleMoves(e)||this._board.isPointInPossibleCaptures(e)||this._freeMode)&&(this.saveClone(),this._board.lastMoveSrc=new s(this._board.activePiece.point.row,this._board.activePiece.point.col),this._board.lastMoveDest=e,this.movePiece(this._board.activePiece,e),this._board.activePiece.point.isEqual(this._board.lastMoveSrc)||(i=!0)),(t||i)&&this.disableSelection(),this.disableSelection();var o=this._board.getPieceByPoint(e.row,e.col);o&&!i&&(this.onFreeMode(o),this.onPieceClicked(o,e))},e.prototype.onMouseDown=function(e,t,i,o){if(0===e.button)if(this.drawProvider.clear(),this._board.activePiece&&t.isEqual(this._board.activePiece.point))this.disabling=!0;else{var n=this._board.getPieceByPoint(t.row,t.col);if(this._freeMode&&n){if(e.ctrlKey)return void(this.board.pieces=this.board.pieces.filter((function(e){return e!==n})));this._board.currentWhitePlayer=n.color===f.WHITE}this.isPieceDisabled(n)||(this._selected?this.handleClickEvent(t,!0):n&&(this.onFreeMode(n),this.onPieceClicked(n,t)))}else this.drawPoint=c.getDrawingPoint(this.heightAndWidth,this.colorStrategy,e.x,e.y,e.ctrlKey,e.altKey,e.shiftKey,i,o)},e.prototype.onMouseUp=function(e,t,i,o){if(0===e.button||this.drawDisabled){if(this.drawProvider.clear(),!this.dragDisabled){if(this._board.activePiece&&t.isEqual(this._board.activePiece.point)&&this.disabling)return this.disableSelection(),void(this.disabling=!1);var n=this._board.getPieceByPoint(t.row,t.col);this.isPieceDisabled(n)||this._selected&&this.handleClickEvent(t,!1)}}else this.addDrawPoint(e.x,e.y,e.ctrlKey,e.altKey,e.shiftKey,i,o)},e.prototype.saveClone=function(){var e=this._board.clone();this._board.reverted&&e.reverse(),this.boardStateProvider.addMove(new I(e))},e.prototype.movePiece=function(e,t,i){var o=this._board.pieces.find((function(e){return e.point.col===t.col&&e.point.row===t.row}));if(o&&e.color!==o.color)this._board.pieces=this._board.pieces.filter((function(e){return e!==o}));else if(o&&e.color===o.color)return;var n=new d(K.format(e.point,t,this._board.reverted),e.constant.name,e.color===f.WHITE?"white":"black",!!o);if((this.moveHistoryProvider.addMove(n),e instanceof g)&&Math.abs(t.col-e.point.col)>1)if(t.col<3){var r=this._board.getPieceByField(e.point.row,0);this._freeMode||(r.point.col=this._board.reverted?2:3)}else{var s=this._board.getPieceByField(e.point.row,7);this._freeMode||(s.point.col=this._board.reverted?4:5)}e instanceof E&&(this.board.checkIfPawnTakesEnPassant(t),this.board.checkIfPawnEnpassanted(e,t)),e.point=t,this.increaseFullMoveCount(),this._board.currentWhitePlayer=!this._board.currentWhitePlayer,this.checkForPawnPromote(e,i)||this.afterMoveActions()},e.prototype.checkForPawnPromote=function(e,t){if(e instanceof E)return 0===e.point.row||7===e.point.row?(this.board.pieces=this.board.pieces.filter((function(t){return t!==e})),t?(L.resolvePromotionChoice(this.board,e,t),this.afterMoveActions(t)):this.openPromoteDialog(e),!0):void 0},e.prototype.checkIfPawnFirstMove=function(e){e instanceof E&&(e.isMovedAlready=!0)},e.prototype.checkIfRookMoved=function(e){e instanceof y&&(e.isMovedAlready=!0)},e.prototype.checkIfKingMoved=function(e){e instanceof g&&(e.isMovedAlready=!0)},e.prototype.afterMoveActions=function(e){this.checkIfPawnFirstMove(this._board.activePiece),this.checkIfRookMoved(this._board.activePiece),this.checkIfKingMoved(this._board.activePiece),this._board.blackKingChecked=this._board.isKingInCheck(f.BLACK,this._board.pieces),this._board.whiteKingChecked=this._board.isKingInCheck(f.WHITE,this._board.pieces);var t=this._board.blackKingChecked||this._board.whiteKingChecked,i=this.checkForPossibleMoves(f.BLACK)||this.checkForPossibleMoves(f.WHITE),o=this.checkForPat(f.BLACK)||this.checkForPat(f.WHITE);this.disabling=!1,this._board.calculateFEN();var n=this.moveHistoryProvider.getLastMove();n&&e&&(n.move+=e),this.moveChange.emit(Object.assign(Object.assign({},n),{check:t,checkmate:i,stalemate:o,fen:this._board.fen,freeMode:this._freeMode}))},e.prototype.checkForPat=function(e){return(e!==f.WHITE||this.board.whiteKingChecked)&&(e!==f.BLACK||this.board.blackKingChecked)?void 0:this.checkForPossibleMoves(e)},e.prototype.openPromoteDialog=function(e){var t=this;this.modal.open((function(i){L.resolvePromotionChoice(t.board,e,i),t.afterMoveActions(i)}))},e.prototype.checkForPossibleMoves=function(e){var t=this;return!this.board.pieces.filter((function(t){return t.color===e})).some((function(i){return i.getPossibleMoves().some((function(o){return!K.willMoveCauseCheck(e,i.point.row,i.point.col,o.row,o.col,t.board)}))||i.getPossibleCaptures().some((function(o){return!K.willMoveCauseCheck(e,i.point.row,i.point.col,o.row,o.col,t.board)}))}))},e.prototype.disableSelection=function(){this._selected=!1,this._board.possibleCaptures=[],this._board.activePiece=null,this._board.possibleMoves=[]},e.prototype.onFreeMode=function(e){this.freeMode&&null!=e&&(this.board.currentWhitePlayer=e.color===f.WHITE)},e.prototype.isPieceDisabled=function(e){if(e&&e.point&&this.board.possibleCaptures.find((function(t){return t.col===e.point.col&&t.row===e.point.row})))return!1;return e&&(this.lightDisabled&&e.color===f.WHITE||this.darkDisabled&&e.color===f.BLACK)},e.prototype.addDrawPoint=function(e,t,i,o,n,r,s){var a=c.getDrawingPoint(this.heightAndWidth,this.colorStrategy,e,t,i,o,n,r,s);if(this.drawPoint.isEqual(a)){var d=new A;d.drawPoint=a,this.drawProvider.containsCircle(d)?this.drawProvider.reomveCircle(d):this.drawProvider.addCircle(d)}else{var h=new T;h.start=this.drawPoint,h.end=a,this.drawProvider.containsArrow(h)?this.drawProvider.removeArrow(h):this.drawProvider.addArrow(h)}},e.prototype.increaseFullMoveCount=function(){this.board.currentWhitePlayer||++this.board.fullMoveCount},Object.defineProperty(e.prototype,"board",{get:function(){return this._board},set:function(e){this._board=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selected",{get:function(){return this._selected},set:function(e){this._selected=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"freeMode",{get:function(){return this._freeMode},set:function(e){this._freeMode=e},enumerable:!1,configurable:!0}),e.prototype.addPiece=function(e,t,i){if(this.freeMode&&i&&e>0&&t>0){var o=K.translateCoordsToIndex(i,this.board.reverted),n=this.board.getPieceByPoint(o.yAxis,o.xAxis);n&&(this.board.pieces=this.board.pieces.filter((function(e){return e!==n})));var r=q.create(o,e,t,this.board);this.saveClone(),this.board.pieces.push(r),this.afterMoveActions()}},e}(),z=function(){function e(){this.board=[],this.pieces=[],this.enPassantPoint=null,this.enPassantPiece=null,this.lastMoveSrc=null,this.lastMoveDest=null,this.possibleCaptures=[],this.possibleMoves=[],this.currentWhitePlayer=!0,this.reverted=!1,this.fullMoveCount=1;for(var e=0;e<8;++e){this.board[e]=[];for(var t=0;t<8;++t)this.board[e][t]=0}}return e.prototype.isXYInPossibleMoves=function(e,t){return this.possibleMoves.some((function(i){return i.row===e&&i.col===t}))},e.prototype.isXYInPossibleCaptures=function(e,t){return this.possibleCaptures.some((function(i){return i.row===e&&i.col===t}))},e.prototype.isXYInSourceMove=function(e,t){return this.lastMoveSrc&&this.lastMoveSrc.row===e&&this.lastMoveSrc.col===t},e.prototype.isXYInDestMove=function(e,t){return this.lastMoveDest&&this.lastMoveDest.row===e&&this.lastMoveDest.col===t},e.prototype.isXYInActiveMove=function(e,t){return this.activePiece&&this.activePiece.point.row===e&&this.activePiece.point.col===t},e.prototype.isPointInPossibleMoves=function(e){return this.possibleMoves.some((function(t){return t.row===e.row&&t.col===e.col}))},e.prototype.isPointInPossibleCaptures=function(e){return this.possibleCaptures.some((function(t){return t.row===e.row&&t.col===e.col}))},e.prototype.reset=function(){this.lastMoveDest=null,this.lastMoveSrc=null,this.whiteKingChecked=!1,this.blackKingChecked=!1,this.possibleCaptures=[],this.possibleMoves=[],this.activePiece=null,this.reverted=!1,this.currentWhitePlayer=!0,this.enPassantPoint=null,this.enPassantPiece=null,this.fullMoveCount=1,this.calculateFEN()},e.prototype.reverse=function(){var e=this;this.reverted=!this.reverted,this.activePiece=null,this.possibleMoves=[],this.possibleCaptures=[],this.pieces.forEach((function(t){return e.reversePoint(t.point)})),this.reversePoint(this.lastMoveSrc),this.enPassantPoint&&this.enPassantPiece&&this.reversePoint(this.enPassantPoint)},e.prototype.clone=function(){return r.cloneDeep(this)},e.prototype.isFieldTakenByEnemy=function(e,t,i){return!(e>7||e<0||t>7||t<0)&&this.pieces.some((function(o){return o.point.col===t&&o.point.row===e&&o.color===i}))},e.prototype.isFieldEmpty=function(e,t){return!(e>7||e<0||t>7||t<0)&&!this.pieces.some((function(i){return i.point.col===t&&i.point.row===e}))},e.prototype.isFieldUnderAttack=function(e,t,i){return this.pieces.filter((function(e){return e.color===i})).some((function(i){return i.getCoveredFields().some((function(i){return i.col===t&&i.row===e}))}))},e.prototype.getPieceByField=function(e,t){if(!this.isFieldEmpty(e,t))return this.pieces.find((function(i){return i.point.col===t&&i.point.row===e}))},e.prototype.isKingInCheck=function(e,t){var i=t.find((function(t){return t.color===e&&t instanceof g}));return!!i&&t.some((function(t){return t.getPossibleCaptures().some((function(e){return e.col===i.point.col&&e.row===i.point.row}))&&t.color!==e}))},e.prototype.getKingByColor=function(e){return this.pieces.find((function(t){return t instanceof g&&t.color===e}))},e.prototype.getCastleFENString=function(e){var t=this.getKingByColor(e);if(!t||t.isMovedAlready)return"";var i="",o=this.getPieceByField(t.point.row,0),n=this.getPieceByField(t.point.row,7);return n instanceof y&&n.color===e&&(n.isMovedAlready||(i+=this.reverted?"q":"k")),o instanceof y&&o.color===e&&(o.isMovedAlready||(i+=this.reverted?"k":"q")),i=i.split("").sort().join(""),e===f.BLACK?i:i.toUpperCase()},e.prototype.getEnPassantFENString=function(){return this.enPassantPoint?this.reverted?String.fromCharCode(104-this.enPassantPoint.col)+(this.enPassantPoint.row+1):String.fromCharCode(97+this.enPassantPoint.col)+(Math.abs(this.enPassantPoint.row-7)+1):"-"},e.prototype.calculateFEN=function(){for(var e="",t=function(t){for(var o=0,n=function(n){var r=i.pieces.find((function(e){return e.point.col===n&&e.point.row===t}));r?(o>0&&(e+=o,o=0),r instanceof y?e+=r.color===f.BLACK?"r":"R":r instanceof v?e+=r.color===f.BLACK?"n":"N":r instanceof w?e+=r.color===f.BLACK?"b":"B":r instanceof C?e+=r.color===f.BLACK?"q":"Q":r instanceof g?e+=r.color===f.BLACK?"k":"K":r instanceof E&&(e+=r.color===f.BLACK?"p":"P")):++o},r=0;r<8;++r)n(r);o>0&&(e+=o),e+="/"},i=this,o=0;o<8;++o)t(o);e=e.substr(0,e.length-1),this.reverted&&(e=e.split("").reverse().join("")),e+=" "+(this.currentWhitePlayer?"w":"b");var n=this.getCastleFENString(f.WHITE)+this.getCastleFENString(f.BLACK);n||(n="-"),e+=" "+n,e+=" "+this.getEnPassantFENString(),e+=" 0",e+=" "+this.fullMoveCount,this.fen=e},e.prototype.isXYInPointSelection=function(e,t){return!1},e.prototype.reversePoint=function(e){e&&(e.row=Math.abs(e.row-7),e.col=Math.abs(e.col-7))},e.prototype.getPieceByPoint=function(e,t){return e=Math.floor(e),t=Math.floor(t),this.pieces.find((function(i){return i.point.col===t&&i.point.row===e}))},e.prototype.checkIfPawnTakesEnPassant=function(e){var t=this;e.isEqual(this.enPassantPoint)&&(this.pieces=this.pieces.filter((function(e){return e!==t.enPassantPiece})),this.enPassantPoint=null,this.enPassantPiece=null)},e.prototype.checkIfPawnEnpassanted=function(e,t){Math.abs(e.point.row-t.row)>1?(this.enPassantPiece=e,this.enPassantPoint=new s((e.point.row+t.row)/2,e.point.col)):(this.enPassantPoint=null,this.enPassantPiece=null)},e.prototype.isKingChecked=function(e){if(e instanceof g)return e.color===f.WHITE?this.whiteKingChecked:this.blackKingChecked},e}(),$=function(){function e(){this.componentMethodCallSource=new n.Subject,this.componentMethodCalled$=this.componentMethodCallSource.asObservable()}return e.prototype.reset=function(){this.componentMethodCallSource.next()},e}();$.ɵfac=function(e){return new(e||$)},$.ɵprov=o.ɵɵdefineInjectable({token:$,factory:$.ɵfac,providedIn:"root"});var X=["myModal"],Y=function(){function e(){this.opened=!1}return e.prototype.open=function(e){this.opened=!0,this.onCloseCallback=e,this.modal.nativeElement.style.display="block"},e.prototype.changeSelection=function(e){this.modal.nativeElement.style.display="none",this.opened=!1,this.onCloseCallback(e)},e}();Y.ɵfac=function(e){return new(e||Y)},Y.ɵcmp=o.ɵɵdefineComponent({type:Y,selectors:[["app-piece-promotion-modal"]],viewQuery:function(e,t){var i;(1&e&&o.ɵɵviewQuery(X,!0),2&e)&&(o.ɵɵqueryRefresh(i=o.ɵɵloadQuery())&&(t.modal=i.first))},decls:13,vars:0,consts:[[1,"container"],["myModal",""],[1,"wrapper"],[1,"content"],[1,"piece-wrapper"],[1,"piece",3,"click"]],template:function(e,t){1&e&&(o.ɵɵelementStart(0,"div",0,1),o.ɵɵelementStart(2,"div",2),o.ɵɵelementStart(3,"div",3),o.ɵɵelementStart(4,"div",4),o.ɵɵelementStart(5,"div",5),o.ɵɵlistener("click",(function(){return t.changeSelection(1)})),o.ɵɵtext(6,"♛"),o.ɵɵelementEnd(),o.ɵɵelementStart(7,"div",5),o.ɵɵlistener("click",(function(){return t.changeSelection(2)})),o.ɵɵtext(8,"♜"),o.ɵɵelementEnd(),o.ɵɵelementStart(9,"div",5),o.ɵɵlistener("click",(function(){return t.changeSelection(3)})),o.ɵɵtext(10,"♝"),o.ɵɵelementEnd(),o.ɵɵelementStart(11,"div",5),o.ɵɵlistener("click",(function(){return t.changeSelection(4)})),o.ɵɵtext(12,"♞"),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd(),o.ɵɵelementEnd())},styles:[".container[_ngcontent-%COMP%]{background-color:rgba(0,0,0,.4);color:#000;display:none;overflow:auto;position:absolute;top:0;z-index:1}.container[_ngcontent-%COMP%], .wrapper[_ngcontent-%COMP%]{height:100%;width:100%}.content[_ngcontent-%COMP%], .wrapper[_ngcontent-%COMP%]{position:relative}.content[_ngcontent-%COMP%]{background-color:#fefefe;border:1px solid #888;font-size:100%;height:40%;margin:auto;padding:10px;top:30%;width:90%}.piece[_ngcontent-%COMP%]{cursor:pointer;display:inline-block;font-size:5rem;height:100%;width:25%}.piece[_ngcontent-%COMP%]:hover{background-color:#ccc;border-radius:5px}.piece-wrapper[_ngcontent-%COMP%]{height:80%;width:100%}#close-button[_ngcontent-%COMP%]{background-color:#4caf50;border:none;border-radius:4px;color:#fff;display:inline-block;padding-left:5px;padding-right:5px;text-align:center;text-decoration:none}.selected[_ngcontent-%COMP%]{border:2px solid #00b919;border-radius:4px;box-sizing:border-box}"]});var V=["boardRef"],Z=["modal"];function J(e,t){if(1&e&&(o.ɵɵelementStart(0,"span",15),o.ɵɵtext(1),o.ɵɵelementEnd()),2&e){var i=o.ɵɵnextContext(2).index,n=o.ɵɵnextContext();o.ɵɵstyleProp("color",i%2==0?n.lightTileColor:n.darkTileColor)("font-size",n.pieceSize/4,"px"),o.ɵɵadvance(1),o.ɵɵtextInterpolate1(" ",n.engineFacade.coords.yCoords[i]," ")}}function ee(e,t){if(1&e&&(o.ɵɵelementStart(0,"span",16),o.ɵɵtext(1),o.ɵɵelementEnd()),2&e){var i=o.ɵɵnextContext().index,n=o.ɵɵnextContext(2);o.ɵɵstyleProp("color",i%2==0?n.lightTileColor:n.darkTileColor)("font-size",n.pieceSize/4,"px"),o.ɵɵadvance(1),o.ɵɵtextInterpolate1(" ",n.engineFacade.coords.xCoords[i]," ")}}function te(e,t){if(1&e){var i=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div",17),o.ɵɵelementStart(1,"div",18),o.ɵɵlistener("cdkDragEnded",(function(e){return o.ɵɵrestoreView(i),o.ɵɵnextContext(3).dragEnded(e)}))("cdkDragStarted",(function(e){return o.ɵɵrestoreView(i),o.ɵɵnextContext(3).dragStart(e)})),o.ɵɵelementEnd(),o.ɵɵelementEnd()}if(2&e){var n=o.ɵɵnextContext().index,r=o.ɵɵnextContext().index,s=o.ɵɵnextContext();o.ɵɵadvance(1),o.ɵɵstyleProp("font-size",s.pieceSize+"px"),o.ɵɵproperty("cdkDragDisabled",s.engineFacade.dragDisabled)("innerHTML",s.engineFacade.pieceIconManager.isDefaultIcons()?s.engineFacade.board.getPieceByPoint(r,n).constant.icon:"",o.ɵɵsanitizeHtml)("ngClass","piece")("ngStyle",s.engineFacade.pieceIconManager.isDefaultIcons()?"":s.getCustomPieceIcons(s.engineFacade.board.getPieceByPoint(r,n)))}}function ie(e,t){if(1&e&&(o.ɵɵelementStart(0,"div",11),o.ɵɵtemplate(1,J,2,5,"span",12),o.ɵɵtemplate(2,ee,2,5,"span",13),o.ɵɵtemplate(3,te,2,6,"div",14),o.ɵɵelementEnd()),2&e){var i=t.index,n=o.ɵɵnextContext().index,r=o.ɵɵnextContext();o.ɵɵstyleProp("background-color",(n+i)%2==0?r.lightTileColor:r.darkTileColor),o.ɵɵclassProp("current-selection",r.engineFacade.board.isXYInActiveMove(n,i))("dest-move",r.engineFacade.board.isXYInDestMove(n,i))("king-check",r.engineFacade.board.isKingChecked(r.engineFacade.board.getPieceByPoint(n,i)))("point-circle",r.engineFacade.board.isXYInPointSelection(n,i))("possible-capture",r.engineFacade.board.isXYInPossibleCaptures(n,i))("possible-point",r.engineFacade.board.isXYInPossibleMoves(n,i))("source-move",r.engineFacade.board.isXYInSourceMove(n,i)),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",r.showCoords&&7===i),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",r.showCoords&&7===n),o.ɵɵadvance(1),o.ɵɵproperty("ngIf",r.engineFacade.board.getPieceByPoint(n,i))}}function oe(e,t){if(1&e&&(o.ɵɵelementStart(0,"div",9),o.ɵɵtemplate(1,ie,4,19,"div",10),o.ɵɵelementEnd()),2&e){var i=t.$implicit;o.ɵɵadvance(1),o.ɵɵproperty("ngForOf",i)}}function ne(e,t){if(1&e&&(o.ɵɵnamespaceSVG(),o.ɵɵelementStart(0,"defs"),o.ɵɵelementStart(1,"marker",19),o.ɵɵelement(2,"path",20),o.ɵɵelementEnd(),o.ɵɵelementEnd()),2&e){var i=t.$implicit;o.ɵɵadvance(1),o.ɵɵproperty("id",i+"Arrow"),o.ɵɵadvance(1),o.ɵɵstyleProp("fill",i)}}function re(e,t){if(1&e&&(o.ɵɵnamespaceSVG(),o.ɵɵelement(0,"line",21)),2&e){var i=t.$implicit;o.ɵɵattribute("marker-end","url(#"+i.end.color+"Arrow)")("stroke",i.end.color)("x1",i.start.x)("x2",i.end.x)("y1",i.start.y)("y2",i.end.y)}}function se(e,t){if(1&e&&(o.ɵɵnamespaceSVG(),o.ɵɵelement(0,"circle",22)),2&e){var i=t.$implicit,n=o.ɵɵnextContext();o.ɵɵattribute("cx",i.drawPoint.x)("cy",i.drawPoint.y)("r",n.engineFacade.heightAndWidth/18)("stroke",i.drawPoint.color)}}var ae=function(){return["red","green","blue","orange"]},ce=function(){function e(e){this.ngxChessBoardService=e,this.darkTileColor=S.DEFAULT_DARK_TILE_COLOR,this.lightTileColor=S.DEFAULT_LIGHT_TILE_COLOR,this.showCoords=!0,this.moveChange=new o.EventEmitter,this.checkmate=new o.EventEmitter,this.stalemate=new o.EventEmitter,this.selected=!1,this.engineFacade=new Q(new z,this.moveChange)}return Object.defineProperty(e.prototype,"size",{set:function(e){e&&e>=S.MIN_BOARD_SIZE&&e<=S.MAX_BOARD_SIZE?this.engineFacade.heightAndWidth=e:this.engineFacade.heightAndWidth=S.DEFAULT_SIZE,this.engineFacade.drawProvider.clear(),this.calculatePieceSize()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"freeMode",{set:function(e){this.engineFacade.freeMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dragDisabled",{set:function(e){this.engineFacade.dragDisabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"drawDisabled",{set:function(e){this.engineFacade.drawDisabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"pieceIcons",{set:function(e){this.pieceIconManager.pieceIconInput=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lightDisabled",{set:function(e){this.engineFacade.lightDisabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"darkDisabled",{set:function(e){this.engineFacade.darkDisabled=e},enumerable:!1,configurable:!0}),e.prototype.onRightClick=function(e){e.preventDefault()},e.prototype.ngOnChanges=function(e){(e.lightDisabled&&this.lightDisabled&&this.engineFacade.board.currentWhitePlayer||e.darkDisabled&&this.darkDisabled&&!this.engineFacade.board.currentWhitePlayer)&&(this.engineFacade.board.possibleCaptures=[],this.engineFacade.board.possibleMoves=[])},e.prototype.ngOnInit=function(){var e=this;this.ngxChessBoardService.componentMethodCalled$.subscribe((function(){e.engineFacade.reset()})),this.calculatePieceSize()},e.prototype.ngAfterViewInit=function(){this.engineFacade.modal=this.modal},e.prototype.onMouseUp=function(e){this.engineFacade.onMouseUp(e,this.getClickPoint(e),this.boardRef.nativeElement.getBoundingClientRect().left,this.boardRef.nativeElement.getBoundingClientRect().top)},e.prototype.reverse=function(){this.selected=!1,this.engineFacade.board.reverse(),this.engineFacade.coords.reverse()},e.prototype.updateBoard=function(e){this.engineFacade.board=e,this.boardLoader.setBoard(this.engineFacade.board),this.engineFacade.board.possibleCaptures=[],this.engineFacade.board.possibleMoves=[]},e.prototype.setFEN=function(e){try{this.engineFacade.boardLoader.loadFEN(e),this.engineFacade.board.possibleCaptures=[],this.engineFacade.board.possibleMoves=[],this.engineFacade.coords.reset()}catch(e){this.engineFacade.boardLoader.addPieces()}},e.prototype.getFEN=function(){return this.engineFacade.board.fen},e.prototype.dragEnded=function(e){this.engineFacade.dragEndStrategy.process(e)},e.prototype.dragStart=function(e){this.engineFacade.dragStartStrategy.process(e)},e.prototype.onMouseDown=function(e){this.engineFacade.onMouseDown(e,this.getClickPoint(e),this.boardRef.nativeElement.getBoundingClientRect().left,this.boardRef.nativeElement.getBoundingClientRect().top)},e.prototype.getClickPoint=function(e){return c.getClickPoint(e,this.boardRef.nativeElement.getBoundingClientRect().top,this.boardRef.nativeElement.getBoundingClientRect().height,this.boardRef.nativeElement.getBoundingClientRect().left,this.boardRef.nativeElement.getBoundingClientRect().width)},e.prototype.calculatePieceSize=function(){this.pieceSize=this.engineFacade.heightAndWidth/10},e.prototype.getCustomPieceIcons=function(e){return JSON.parse('{ "background-image": "url(\''+this.engineFacade.pieceIconManager.getPieceIcon(e)+"')\"}")},e.prototype.move=function(e){this.engineFacade.move(e)},e.prototype.getMoveHistory=function(){return this.engineFacade.getMoveHistory()},e.prototype.reset=function(){this.engineFacade.reset()},e.prototype.undo=function(){this.engineFacade.undo()},e.prototype.addPiece=function(e,t,i){this.engineFacade.addPiece(e,t,i)},e}();ce.ɵfac=function(e){return new(e||ce)(o.ɵɵdirectiveInject($))},ce.ɵcmp=o.ɵɵdefineComponent({type:ce,selectors:[["ngx-chess-board"]],viewQuery:function(e,t){var i;(1&e&&(o.ɵɵviewQuery(V,!0),o.ɵɵviewQuery(Z,!0)),2&e)&&(o.ɵɵqueryRefresh(i=o.ɵɵloadQuery())&&(t.boardRef=i.first),o.ɵɵqueryRefresh(i=o.ɵɵloadQuery())&&(t.modal=i.first))},hostBindings:function(e,t){1&e&&o.ɵɵlistener("contextmenu",(function(e){return t.onRightClick(e)}))},inputs:{darkTileColor:"darkTileColor",lightTileColor:"lightTileColor",showCoords:"showCoords",size:"size",freeMode:"freeMode",dragDisabled:"dragDisabled",drawDisabled:"drawDisabled",pieceIcons:"pieceIcons",lightDisabled:"lightDisabled",darkDisabled:"darkDisabled"},outputs:{moveChange:"moveChange",checkmate:"checkmate",stalemate:"stalemate"},features:[o.ɵɵNgOnChangesFeature],decls:12,vars:15,consts:[["id","board",3,"pointerdown","pointerup"],["boardRef",""],["id","drag"],["class","board-row",4,"ngFor","ngForOf"],[2,"position","absolute","top","0","pointer-events","none"],[4,"ngFor","ngForOf"],["class","arrow",4,"ngFor","ngForOf"],["fill-opacity","0.0","stroke-width","2",4,"ngFor","ngForOf"],["modal",""],[1,"board-row"],["class","board-col",3,"current-selection","dest-move","king-check","point-circle","possible-capture","possible-point","source-move","background-color",4,"ngFor","ngForOf"],[1,"board-col"],["class","yCoord",3,"color","font-size",4,"ngIf"],["class","xCoord",3,"color","font-size",4,"ngIf"],["style","height:100%; width:100%",4,"ngIf"],[1,"yCoord"],[1,"xCoord"],[2,"height","100%","width","100%"],["cdkDrag","",3,"cdkDragDisabled","innerHTML","ngClass","ngStyle","cdkDragEnded","cdkDragStarted"],["markerHeight","13","markerWidth","13","orient","auto","refX","9","refY","6",3,"id"],["d","M2,2 L2,11 L10,6 L2,2"],[1,"arrow"],["fill-opacity","0.0","stroke-width","2"]],template:function(e,t){if(1&e){var i=o.ɵɵgetCurrentView();o.ɵɵelementStart(0,"div",0,1),o.ɵɵlistener("pointerdown",(function(e){return o.ɵɵrestoreView(i),!o.ɵɵreference(11).opened&&t.onMouseDown(e)}))("pointerup",(function(e){return o.ɵɵrestoreView(i),!o.ɵɵreference(11).opened&&t.onMouseUp(e)})),o.ɵɵelementStart(2,"div",2),o.ɵɵtemplate(3,oe,2,1,"div",3),o.ɵɵelementEnd(),o.ɵɵnamespaceSVG(),o.ɵɵelementStart(4,"svg",4),o.ɵɵtemplate(5,ne,3,3,"defs",5),o.ɵɵtemplate(6,re,1,6,"line",6),o.ɵɵpipe(7,"async"),o.ɵɵtemplate(8,se,1,4,"circle",7),o.ɵɵpipe(9,"async"),o.ɵɵelementEnd(),o.ɵɵnamespaceHTML(),o.ɵɵelement(10,"app-piece-promotion-modal",null,8),o.ɵɵelementEnd()}2&e&&(o.ɵɵstyleProp("height",t.engineFacade.heightAndWidth,"px")("width",t.engineFacade.heightAndWidth,"px"),o.ɵɵadvance(3),o.ɵɵproperty("ngForOf",t.engineFacade.board.board),o.ɵɵadvance(1),o.ɵɵattribute("height",t.engineFacade.heightAndWidth)("width",t.engineFacade.heightAndWidth),o.ɵɵadvance(1),o.ɵɵproperty("ngForOf",o.ɵɵpureFunction0(14,ae)),o.ɵɵadvance(1),o.ɵɵproperty("ngForOf",o.ɵɵpipeBind1(7,10,t.engineFacade.drawProvider.arrows$)),o.ɵɵadvance(2),o.ɵɵproperty("ngForOf",o.ɵɵpipeBind1(9,12,t.engineFacade.drawProvider.circles$)))},directives:[i.NgForOf,Y,i.NgIf,t.CdkDrag,i.NgClass,i.NgStyle],pipes:[i.AsyncPipe],styles:['@charset "UTF-8";#board[_ngcontent-%COMP%]{font-family:Courier New,serif;position:relative}.board-row[_ngcontent-%COMP%]{display:block;height:12.5%;position:relative;width:100%}.board-col[_ngcontent-%COMP%]{cursor:default;display:inline-block;height:100%;position:relative;vertical-align:top;width:12.5%}.piece[_ngcontent-%COMP%]{-moz-user-select:none;-webkit-user-select:none;background-size:cover;color:#000!important;cursor:-webkit-grab;cursor:grab;height:100%;justify-content:center;text-align:center;user-select:none;width:100%}.piece[_ngcontent-%COMP%], .piece[_ngcontent-%COMP%]:after{box-sizing:border-box}.piece[_ngcontent-%COMP%]:after{content:"​"}#drag[_ngcontent-%COMP%]{height:100%;width:100%}.possible-point[_ngcontent-%COMP%]{background:radial-gradient(#13262f 15%,transparent 20%)}.possible-capture[_ngcontent-%COMP%]:hover, .possible-point[_ngcontent-%COMP%]:hover{opacity:.4}.possible-capture[_ngcontent-%COMP%]{background:radial-gradient(transparent 0,transparent 80%,#13262f 0);box-sizing:border-box;margin:0;opacity:.5;padding:0}.king-check[_ngcontent-%COMP%]{background:radial-gradient(ellipse at center,red 0,#e70000 25%,rgba(169,0,0,0) 89%,rgba(158,0,0,0) 100%)}.source-move[_ngcontent-%COMP%]{background-color:rgba(146,111,26,.79)!important}.dest-move[_ngcontent-%COMP%]{background-color:#b28e1a!important}.current-selection[_ngcontent-%COMP%]{background-color:#72620b!important}.yCoord[_ngcontent-%COMP%]{right:.2em}.xCoord[_ngcontent-%COMP%], .yCoord[_ngcontent-%COMP%]{-moz-user-select:none;-webkit-user-select:none;box-sizing:border-box;cursor:pointer;font-family:Lucida Console,Courier,monospace;position:absolute;user-select:none}.xCoord[_ngcontent-%COMP%]{bottom:0;left:.2em}.hovering[_ngcontent-%COMP%]{background-color:red!important}.arrow[_ngcontent-%COMP%]{stroke-width:2}svg[_ngcontent-%COMP%]{filter:drop-shadow(1px 1px 0 #111) drop-shadow(-1px 1px 0 #111) drop-shadow(1px -1px 0 #111) drop-shadow(-1px -1px 0 #111)}[_nghost-%COMP%]{display:inline-block!important}']});var de=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[$]}},e}();de.ɵmod=o.ɵɵdefineNgModule({type:de}),de.ɵinj=o.ɵɵdefineInjector({factory:function(e){return new(e||de)},imports:[[i.CommonModule,t.DragDropModule]]}),("undefined"==typeof ngJitMode||ngJitMode)&&o.ɵɵsetNgModuleScope(de,{declarations:[ce,Y],imports:[i.CommonModule,t.DragDropModule],exports:[ce]}),e.HistoryMove=d,e.NgxChessBoardComponent=ce,e.NgxChessBoardModule=de,e.NgxChessBoardService=$,e.PiecePromotionModalComponent=Y,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-chess-board.umd.min.js.map